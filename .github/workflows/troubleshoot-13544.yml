# https://github.com/actions/runner-images/issues/13544
name: troubleshoot-13544

on:
    workflow_dispatch:
    # push:
    #     branches: [ main ]
    #     tags: [ 'v[0-9]+.[0-9]+.[0-9]+*' ]

jobs:
    unit-tests:
        name: "Unit tests"
        strategy:
            fail-fast: false
            matrix:
                os: [ ubuntu-latest, windows-latest, macos-latest ]
        runs-on: ${{ matrix.os }}
        steps:
            -   uses: actions/checkout@v6
                with:
                    repository: 'aweXpect/Mockolate'
                    ref: '602f10428e960f2bf915e1381b26bf4245c6dd48' # before https://github.com/aweXpect/Mockolate/pull/372
                    fetch-depth: 0
            - run: |
                dotnet --list-runtimes
                dotnet --list-sdks
            # -   name: Setup .NET SDKs
            #     uses: actions/setup-dotnet@v5
            #     with:
            #         dotnet-version: |
            #             8.0.x
            #             10.0.x
            - run: |
                dotnet --list-runtimes
                dotnet --list-sdks
            -   name: Run unit tests (windows)
                if: matrix.os == 'windows-latest'
                run: ./build.ps1 CodeCoverage
            -   name: Run unit tests (ubuntu|macos)
                if: matrix.os != 'windows-latest'
                run: ./build.sh CodeCoverage
            # -   name: Upload artifacts
            #     if: always()
            #     uses: actions/upload-artifact@v6
            #     with:
            #         name: ${{ runner.os }}-artifacts
            #         path: |
            #             ./Artifacts/*
            #             ./TestResults/*.trx
